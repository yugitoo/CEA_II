---
title: "CEA II"
author:
- "Hei Yin Kwok"
- "Karine Tavares Cruz"
- "Yugo Oyama"
date: "2/9/2021"
output: pdf_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Bibliotecas
```{r bibliotecas}
library(readxl) # ler excel
library(robustbase) #plotar boxplot
library(RColorBrewer) #baixar paleta de cores
library("summarytools") 
library(dplyr) # manipular bd
library(tidyr) # manipular bd
library(corrplot)
library(ggplot2)

```


## Leitura dos dados
```{r leitura_dados}
bd <- read_excel("Dados.xlsx", sheet = "dados")
bd$grupo <- factor(bd$grupo)
bd$q4 <- factor(bd$q4)
bd$q5 <- factor(bd$q5)
bd$q7 <- factor(bd$q7)
bd$q8 <- factor(bd$q8)
head(bd)
```

## Categorizando Variáveis
```{r}

# Grupo
bd$grupo <- as.factor(bd$grupo)
bd$grupo <- plyr::mapvalues(bd$grupo,  from = c("1", "2", "3"), to = c("AVE dirige", "AVE não dirige", "Controle"))
bd$grupo <- relevel(bd$grupo, "Controle")

# Estado Civil
bd$estado_civil <- as.factor(bd$estado_civil)
bd$estado_civil <-plyr::mapvalues(bd$estado_civil,  from = c("1", "2", "3", "4"), to = c("solteiro", "casado", "viuvo", "divorciado"))

# Lado encefalico Acometido
bd$lado_encefalico_acometido <- as.factor(bd$lado_encefalico_acometido)
bd$lado_encefalico_acometido <- plyr::mapvalues(bd$lado_encefalico_acometido,  from = c("1", "2", "3"), to = c("direito", "esquerdo", "bilateral"))

# Lado Parétipo
bd$lado_paretico <- as.factor(bd$lado_paretico)
bd$lado_paretico <-plyr::mapvalues(bd$lado_paretico,  from = c("1", "2", "3"), to = c("direito", "esquerdo", "misto"))

# Tipo do AVE
bd$tipo_ave <- as.factor(bd$tipo_ave)
bd$tipo_ave <-plyr::mapvalues(bd$tipo_ave,  from = c("0", "1", "2", "3", "4"), to = c("nao_há", "isquemico", "hemorragico", "misto", "lacunar"))


# Questão 4
bd$q4 <- as.factor(bd$q4)
bd$q4 <-plyr::mapvalues(bd$q4,  from = c("1", "2"), to = c("sim", "não"))

# Questão 5
bd$q5 <- as.factor(bd$q5)
bd$q5 <-plyr::mapvalues(bd$q5,  from = c("1", "2"), to = c("sim", "não"))

# Questão 7
bd$q7 <- as.factor(bd$q7)
bd$q7 <-plyr::mapvalues(bd$q7,  from = c("1", "2"), to = c("sim", "não"))

# Questão 8
bd$q8 <- as.factor(bd$q8)
bd$q8 <-plyr::mapvalues(bd$q8,  from = c("1", "2"), to = c("sim", "não"))


# Questão 9
bd$q9 <- as.factor(bd$q9)
bd$q9 <-plyr::mapvalues(bd$q9,  from = c("0", "1", "2", "3"), to = c("nenhum_pouco", "um_pouco", "muito", "extremamente"))

# chuva
bd$chuva <- as.factor(bd$chuva)
bd$chuva <- plyr::mapvalues(bd$chuva,  from = c("1", "2", "3"), to = c("sim", "não", "ultimo_caso"))

# noite
bd$noite <- as.factor(bd$noite)
bd$noite <- plyr::mapvalues(bd$noite,  from = c("1", "2", "3"), to = c("sim", "não", "ultimo_caso"))

# congestionamento
bd$congestionamento <- as.factor(bd$congestionamento)
bd$congestionamento <- plyr::mapvalues(bd$congestionamento,  from = c("1", "2", "3"), to = c("sim", "não", "ultimo_caso"))

# rush
bd$rush <- as.factor(bd$rush)
bd$rush <- plyr::mapvalues(bd$rush,  from = c("1", "2", "3"), to = c("sim", "não", "ultimo_caso"))


# Locais que Dirige
bd$locais <- as.factor(bd$locais)
bd$locais <- plyr::mapvalues(bd$locais,  from = c("1", "2", "3"), to = c("perto_de_casa", "perto de casa/qq lugar/não rodovia", "qq lugar/ rodovia"))


# Estereopsia
bd$estereopsia <- as.factor(bd$estereopsia)
bd$estereopsia <- plyr::mapvalues(bd$estereopsia,  from = c("1", "2"), to = c("sim", "não"))

# Visao Cromatica
bd$visao_cromatica <- as.factor(bd$visao_cromatica)
bd$visao_cromatica <- plyr::mapvalues(bd$visao_cromatica,  from = c("1", "2"), to = c("sim", "não"))

# Campimetria Periferica
bd$campimetria_periferica <- as.factor(bd$campimetria_periferica)
bd$campimetria_periferica <- plyr::mapvalues(bd$campimetria_periferica,  from = c("1", "2"), to = c("sim", "não"))

#EIAVD
bd$eiavd <- as.factor(bd$eiavd)


```
```{r}
tapply(bd$n_palavras_sentado, bd$grupo, summary)
tapply(bd$n_palavras_em_pe, bd$grupo, summary)


```

## Analise descritiva

### Parametros uteis
```{r parametros}
cores <- brewer.pal(3, "Set2")
col_names <- names(bd)

```


### Métricas gerais:
```{r metricas}
summary(bd)
bd %>% descr(., stats = c('mean','sd', 'min', 'q1', 'med', 'q3', 'max'), justify = "c",
                split.tables = 100, round.digits = 3, transpose = TRUE, headings = TRUE)


```


```{r}
plota_boxplot = function(col_box, titulos, densidade, tamanho=c(2,3)){

  par(mfrow=tamanho) # organiza a disposicao dos graficos
  for (i in 1:length(col_box)) {
    j <- eval(parse(text = paste0("bd$",col_box[i]))) # coluna i
    # adjbox(split(j,bd$grupo), col=cores, main = paste0(i," por grupo"))
        boxplot(j ~ bd$grupo,col=cores, main = paste0(titulos[i]," por grupo"), xlab='')

    boxplot(j, col=cores, main = paste0(titulos[i]," geral"), xlab='')
    if (densidade==T){
    plot(density(na.omit(j)), main = paste0(titulos[i]," geral"))}
  }
}

## Plota dispersões
plota_disp = function(col_disp, col_resp, titulos_disp, titulos_resp){


  grupo<-factor(bd$grupo)# organiza a disposicao dos graficos
  for (i in 1:length(col_disp)) {
    j <- eval(parse(text = paste0("bd$",col_disp[i]))) # coluna i
    for (k in 1:length(col_resp)) {
      l <- eval(parse(text = paste0("bd$",col_resp[k])))
      df<-data.frame(j, l, grupo)
      geral <- ggplot(df, aes(y = l, x =j)) +
      geom_point() +
      labs(x=titulos_disp[i], y=titulos_resp[k]) +
      theme_bw() +
      theme(legend.position = "None") 
      print(geral)
    
    fatiado <-ggplot(df, aes(y = l, x =j)) +
      geom_point(aes(colour = factor(grupo))) +
      facet_wrap("grupo") +
      labs(x=titulos_disp[i], y=titulos_resp[k]) +
      scale_color_brewer(palette = "Set2") +
      theme_bw() +
      theme(legend.position = "None")
    print(fatiado)
  }
}
}
```

### Tempos de reação
```{r}
col_box<-c("tr_media_com_distrator")
titulos<-c('Tempo de Reação Com Distrator')
plota_boxplot(col_box, titulos, densidade = T, tamanho = c(1,3))

col_box<-c("tr_media_sem_distrator")
titulos<-c('Tempo de Reação Sem Distrator')
plota_boxplot(col_box, titulos, densidade = T, tamanho = c(1,3))
```

### Velocidades
```{r}
col_box<-c('velocidade_com_distrator', 'velocidade_sem_distrator')
titulos <- c("Velocidade Com Distrator", "Velocidade Sem Distrator")
plota_boxplot(col_box, titulos, densidade = F, tamanho = c(1,2))

col_resp<-c('tr_media_com_distrator', 'tr_media_sem_distrator')
col_disp<-c('velocidade_com_distrator', 'velocidade_sem_distrator')
titulos_disp <- c("Velocidade Com Distrator", "Velocidade Sem Distrator")
titulos_resp <- c("Tempo Médio Com Distrator", "Tempo Médio Sem Distrator")
plota_disp(col_disp, col_resp, titulos_disp, titulos_resp)
```

### Desvio de Pista e Perda De Placa
```{r}
# Vezes que deixou a via sem distrator
deixou_via_sem = table(bd$grupo, bd$deixou_a_via_sem_distrator)
deixou_via_sem
chisq.test(bd$grupo, bd$deixou_a_via_sem_distrator)

aggregate(bd$deixou_a_via_sem_distrator, by=list(Category=bd$grupo), FUN=sum)

# Vezes que perdeu a placa sem distrator
perdeu_placa_sem = table(bd$grupo, bd$perdeu_placa_sem_distrator)
perdeu_placa_sem 
chisq.test(bd$grupo, bd$perdeu_placa_sem_distrator)
aggregate(bd$perdeu_placa_sem_distrator, by=list(Category=bd$grupo), FUN=sum)

# Vezes que deixou a via com distrator
deixou_via_com = table(bd$grupo, bd$deixou_via_com_distrator)
deixou_via_com  # quantas pessoas cometeram x erros
chisq.test(bd$grupo, bd$deixou_via_com_distrator)

aggregate(bd$deixou_via_com_distrator, by=list(Category=bd$grupo), FUN=sum) # quantos erros
# Vezes que perdeu a placa com distrator
perdeu_placa_com = table(bd$grupo, bd$perdeu_placa_com_distrator)
perdeu_placa_com # quantas pessoas cometeram x erros
chisq.test(bd$grupo, bd$perdeu_placa_com_distrator)

aggregate(bd$perdeu_placa_com_distrator, by=list(Category=bd$grupo), FUN=sum) 

```


#### Atenção Automática, Velocidade De Processamento, Atenção Controlada, Atenção Executiva

```{r}

## Tempos

col_box <- c("fdt_atencao_automatica_tempo", "velocidade_processamento_tempo", "atencao_controlada_tempo", "atencao_executiva_tempo") 
titulos <- c("Atenção Automática (s)", "Velocidade De Processamento (s)", 
             "Atenção Controlada (s)", "Atenção Executiva (s)")
plota_boxplot(col_box, titulos, densidade = F, tamanho = c(1,2))

## Dispersao
col_disp <-  c("fdt_atencao_automatica_tempo", "velocidade_processamento_tempo", "atencao_controlada_tempo", "atencao_executiva_tempo") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator") # colunas com variaveis resposta
titulos_disp <- c("Atenção Automática (s)", "Velocidade De Processamento (s)", 
             "Atenção Controlada (s)", "Atenção Executiva (s)")
titulos_resp <- c("Tempo Médio Com Distrator", "Tempo Médio Sem Distrator")
plota_disp(col_disp, col_resp, titulos_disp, titulos_resp)


## ERROS:

atencao_automatica = table(bd$grupo, bd$atencao_automatica_erros_total)
atencao_automatica
aggregate(bd$atencao_automatica_erros_total, by=list(Category=bd$grupo), FUN=sum)

velocidade_processamento = table(bd$grupo, bd$velocidade_processamento_erros_total)
velocidade_processamento
aggregate(bd$velocidade_processamento_erros_total, by=list(Category=bd$grupo), FUN=sum)


atencao_controlada = table(bd$grupo, bd$atencao_controlada_erros_total)
atencao_controlada
aggregate(bd$atencao_controlada_erros_total, by=list(Category=bd$grupo), FUN=sum)


atencao_executiva = table(bd$grupo, bd$atencao_executiva_erros_total)
atencao_executiva
aggregate(bd$atencao_executiva_erros_total, by=list(Category=bd$grupo), FUN=sum)

```

### Trail A
```{r}
## TEMPO
col_box <- c("trail_a_tempo", "trail_b_tempo") # colunas que serao feitos boxplots
titulos <- c("Trail A (segundos)", "Trail B (segundos)")
plota_boxplot(col_box, titulos, densidade = F, tamanho = c(1,2))

#ERROS

trail_a_erros = table(bd$grupo, bd$trail_a_erros)
trail_a_erros
aggregate(bd$trail_a_erros, by=list(Category=bd$grupo), FUN=sum)

trail_b_erros = table(bd$grupo, bd$trail_b_erros)
trail_b_erros
aggregate(bd$trail_b_erros, by=list(Category=bd$grupo), FUN=sum)

## Dispersão
col_disp <-  c("trail_a_tempo", "trail_b_tempo") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator") # colunas com variaveis resposta
titulos_disp <- c("Trail A (segundos)", "Trail B (segundos)")
titulos_resp <- c("Tempo Médio Com Distrator", "Tempo Médio Sem Distrator")
plota_disp(col_disp, col_resp, titulos_disp, titulos_resp)

```

## Meses De AVE
```{r}
col_box <- c("ave_meses") 
titulos <- c("Meses Desde AVE")
plota_boxplot(col_box, titulos, densidade = F, tamanho = c(1,2))

#Lado Parético
lado = table(bd$grupo, bd$lado_paretico)
lado

boxplot(bd$tr_media_sem_distrator~bd$lado_paretico,col=cores, main = "Tempo de Reação Sem Distrator", xlab='')

boxplot(bd$tr_media_com_distrator~bd$lado_paretico,col=cores, main = "Tempo de Reação Com Distrator", xlab='')

#Locais:
locais = table(bd$grupo, bd$locais)
locais
chisq.test(bd$grupo, bd$locais)

```

### Inibição e Flexibilidade
```{r}
col_box <- c("inibição_total", "flexibilidade_tempo") 
titulos = c('Inibição', 'Flexibilidade')

plota_boxplot(col_box, titulos, densidade = F, tamanho = c(1,2))

col_disp<-c("inibição_total", "flexibilidade_tempo")
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator") # colunas com variaveis resposta
titulos_disp <- c('Inibição', 'Flexibilidade')
titulos_resp <- c("Tempo Médio Com Distrator", "Tempo Médio Sem Distrator")
plota_disp(col_disp, col_resp, titulos_disp, titulos_resp)

```

### Figura Complexa de Rey
```{r}
col_box <- c("frey_copia_tempo") 
titulos <- c("Figura Complexa de Rey")
plota_boxplot(col_box, titulos, densidade=F)

col_disp<-c("frey_copia_tempo")
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator")
titulos_disp <- c("Figura Complexa de Rey")
titulos_resp <- c("Tempo Médio Com Distrator", "Tempo Médio Sem Distrator")
plota_disp(col_disp, col_resp, titulos_disp, titulos_resp)

```

#### Adm Tornozelo Direito

```{r}

col_box <- c("adm_tornozelo_d") # colunas que serao feitos boxplots
titulos <- c('Tornozelo Direito')
plota_boxplot(col_box)

## Dispersao
col_disp <-  c("adm_tornozelo_d") 
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator") 
titulos_disp <- c("Tornozelo Direito")
titulos_resp <- c("Tempo Médio Com Distrator", "Tempo Médio Sem Distrator")

plota_disp(col_disp, col_resp, titulos_disp, titulos_resp)

```

#### Correlações
```{r}
# 'lado_paretico', 'locais',
```


```{r}
finais<-bd [, c('grupo','ave_meses', 'tug_simples_segundo',
              'tug_dupla_tarefa_segundos', 'n_palavras_sentado', 'n_palavras_em_pe', 
              'adm_tornozelo_d', 'fdt_atencao_automatica_tempo', 'velocidade_processamento_tempo'
              , 'atencao_controlada_tempo', 'atencao_executiva_tempo', 
              'atencao_automatica_erros_total', 
              'velocidade_processamento_erros_total', 
              'atencao_controlada_erros_total', 
              'atencao_executiva_erros_total', 
              'inibição_total', 'flexibilidade_tempo', 
              'trail_a_erros', 'trail_b_erros', 'trail_a_tempo', 'trail_b_tempo', 
              'frey_copia_tempo', 'tr_media_com_distrator', 'tr_media_sem_distrator', 
              'perdeu_placa_com_distrator', 'perdeu_placa_sem_distrator',
              'deixou_via_com_distrator', 'deixou_a_via_sem_distrator', 
              'velocidade_com_distrator', 'velocidade_sem_distrator', 'escolaridade' )]

par(mfrow=c(1, 1))
correlacoes = cor(finais[, c(-1)], use = "na.or.complete")
corrplot(correlacoes, method = 'color', order = 'alphabet', tl.pos='n') 

# Correlações do grupo de AVE DIRIGE:
cor_dirige = finais[finais[, c('grupo')]=='AVE dirige', c(-1)]
correlacoes_dirige = cor(cor_dirige, use = "na.or.complete")
corrplot(correlacoes_dirige, method = 'color', order = 'alphabet', tl.pos='n')

# Correlações do grupo de AVE NÃO DIRIGE:
cor_n_dirige = finais[finais[, c('grupo')]=='AVE não dirige', c(-1)]
correlacoes_n_dirige = cor(cor_n_dirige, use = "na.or.complete")
corrplot(correlacoes_n_dirige, method = 'color', order = 'alphabet', tl.pos='n')

# Correlações do grupo de Controle:
cor_controle = finais[finais[, c('grupo')]=='Controle', c(-1, -2)]
correlacoes_controle = cor(cor_controle, use = "na.or.complete")
corrplot(correlacoes_controle, method = 'color', order = 'alphabet', tl.pos='n')




```

#### TUG
```{r}
## Dispersao

# colunas com variaveis resposta

plota_disp(col_disp, col_resp, titulos_disp, titulos_resp)
col_disp <-  c("tug_simples_segundo", "tug_dupla_tarefa_segundos", "n_palavras_sentado", "n_palavras_em_pe") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator")  # colunas com variaveis resposta
titulos_disp <- c("TUG Simples (s)", "TUG Dupla (s)", 
                  "Nº palavras sentado(s)", "Nº palavras em pé(s)")
titulos_resp <- c("Tempo Médio Com Distrator", "Tempo Médio Sem Distrator")
plota_disp(col_disp, col_resp, titulos_disp, titulos_resp)

## Dispersao
col_disp <-  c("tug_simples_segundo", "tug_dupla_tarefa_segundos", "n_palavras_sentado", "n_palavras_em_pe") # colunas que serao feitas grafico de dispersao
col_resp <- c("velocidade_com_distrator","velocidade_sem_distrator") # colunas com variaveis resposta
 
```
#### Escolaridade
```{r}

mod_escol1 <-lm(tr_media_com_distrator ~ escolaridade, data=bd)
summary(mod_escol1)

mod_escol2 <-lm(tr_media_sem_distrator ~ escolaridade, data=bd)
summary(mod_escol2)


#significativo

```

#### Tempo desde AVE
```{r}

mod_ave_meses1 <-lm(tr_media_com_distrator ~ ave_meses, data=bd)
summary(mod_ave_meses1)

mod_ave_meses2 <-lm(tr_media_sem_distrator ~ ave_meses, data=bd)
summary(mod_ave_meses2)

#não significativo

```



#### Tempo que dirigia antes do AVE
```{r}

mod_dirigia1 <-lm(tr_media_com_distrator ~ q1, data=bd)
summary(mod_dirigia1)

mod_dirigia2 <-lm(tr_media_sem_distrator ~ q1, data=bd)
summary(mod_dirigia2)

#nao significativo

```
#### Lado parétipo
```{r}

mod_lado_paretico1 <-lm(tr_media_com_distrator ~ lado_paretico, data=bd)
summary(mod_lado_paretico1)

mod_lado_paretico2 <-lm(tr_media_sem_distrator ~ lado_paretico, data=bd)
summary(mod_lado_paretico2)

#significativo

```
#### Locais em que se sente confortável para dirigir
```{r}

mod_locais1 <-lm(tr_media_com_distrator ~ locais, data=bd)
summary(mod_locais1)

mod_locais2 <-lm(tr_media_sem_distrator ~ locais, data=bd)
summary(mod_locais2)

#significativo: locaisqq lugar/ rodovia

```
#### TUG SIMPLES
```{r}

mod_tug_simples_segundo1 <-lm(tr_media_com_distrator ~ tug_simples_segundo, data=bd)
summary(mod_tug_simples_segundo1)

mod_tug_simples_segundo2 <-lm(tr_media_sem_distrator ~ tug_simples_segundo, data=bd)
summary(mod_tug_simples_segundo2)

#significativo

```
#### TUG DUPLA TAREFA
```{r}

mod_tug_dupla_tarefa_segundos1 <-lm(tr_media_com_distrator ~ tug_dupla_tarefa_segundos, data=bd)
summary(mod_tug_dupla_tarefa_segundos1)

mod_tug_dupla_tarefa_segundos2 <-lm(tr_media_sem_distrator ~ tug_dupla_tarefa_segundos, data=bd)
summary(mod_tug_dupla_tarefa_segundos2)

#significativo

```
#### Nº de palavras sentado
```{r}

mod_n_palavras_sentado1 <-lm(tr_media_com_distrator ~ n_palavras_sentado, data=bd)
summary(mod_n_palavras_sentado1)

mod_n_palavras_sentado2 <-lm(tr_media_sem_distrator ~ n_palavras_sentado, data=bd)
summary(mod_n_palavras_sentado2)

#significativo

```
#### Nº de palavras em pé
```{r}

mod_n_palavras_em_pe1 <-lm(tr_media_com_distrator ~ n_palavras_em_pe, data=bd)
summary(mod_n_palavras_em_pe1)

mod_n_palavras_em_pe2 <-lm(tr_media_sem_distrator ~ n_palavras_em_pe, data=bd)
summary(mod_n_palavras_em_pe2)

#significativo

```
#### ADM Tornozelo direito
```{r}

mod_adm_tornozelo_d1 <-lm(tr_media_com_distrator ~ adm_tornozelo_d, data=bd)
summary(mod_adm_tornozelo_d1)

mod_adm_tornozelo_d2 <-lm(tr_media_sem_distrator ~ adm_tornozelo_d, data=bd)
summary(mod_adm_tornozelo_d2)

#não significativo

```
#### Atenção automática
```{r}

mod_fdt_atencao_automatica_tempo1 <-lm(tr_media_com_distrator ~ fdt_atencao_automatica_tempo, data=bd)
summary(mod_fdt_atencao_automatica_tempo1)

mod_fdt_atencao_automatica_tempo2 <-lm(tr_media_sem_distrator ~ fdt_atencao_automatica_tempo, data=bd)
summary(mod_fdt_atencao_automatica_tempo2)

#significativo

```

#### trail_b_erros 
```{r}

mod_trail_b_erros1 <-lm(tr_media_com_distrator ~ trail_b_erros, data=bd)
summary(mod_trail_b_erros1)

mod_trail_b_erros2 <-lm(tr_media_sem_distrator ~ trail_b_erros, data=bd)
summary(mod_trail_b_erros2)

#significativo

```
#### trail_a_tempo
```{r}

mod_trail_a_tempo1 <-lm(tr_media_com_distrator ~ trail_a_tempo, data=bd)
summary(mod_trail_a_tempo1)

mod_trail_a_tempo2 <-lm(tr_media_sem_distrator ~ trail_a_tempo, data=bd)
summary(mod_trail_a_tempo2)

#significativo

```

#### trail_b_tempo 
```{r}

mod_trail_b_tempo1 <-lm(tr_media_com_distrator ~ trail_b_tempo, data=bd)
summary(mod_trail_b_tempo1)

mod_trail_b_tempo2 <-lm(tr_media_sem_distrator ~ trail_b_tempo, data=bd)
summary(mod_trail_b_tempo2)

#significativo

```

#### frey_copia_tempo
```{r}

mod_frey_copia_tempo1 <-lm(tr_media_com_distrator ~ frey_copia_tempo, data=bd)
summary(mod_frey_copia_tempo1)

mod_frey_copia_tempo2 <-lm(tr_media_sem_distrator ~ frey_copia_tempo, data=bd)
summary(mod_frey_copia_tempo2)

#significativo

```
#### perdeu_placa_com_distrator 
```{r}

mod_perdeu_placa_com_distrator1 <-lm(tr_media_com_distrator ~ perdeu_placa_com_distrator, data=bd)
summary(mod_perdeu_placa_com_distrator1)

mod_perdeu_placa_com_distrator2 <-lm(tr_media_sem_distrator ~ perdeu_placa_com_distrator, data=bd)
summary(mod_perdeu_placa_com_distrator2)

#significativo

```
#### perdeu_placa_sem_distrator 
```{r}

mod_perdeu_placa_sem_distrator1 <-lm(tr_media_com_distrator ~ perdeu_placa_sem_distrator, data=bd)
summary(mod_perdeu_placa_sem_distrator1)

mod_perdeu_placa_sem_distrator2 <-lm(tr_media_sem_distrator ~ perdeu_placa_sem_distrator, data=bd)
summary(mod_perdeu_placa_sem_distrator2)

#nao significativo

```
#### deixou_via_com_distrator 
```{r}

mod_deixou_a_via_com_distrator1 <-lm(tr_media_com_distrator ~ deixou_via_com_distrator, data=bd)
summary(mod_deixou_a_via_com_distrator1)

mod_deixou_a_via_com_distrator2 <-lm(tr_media_sem_distrator ~ deixou_via_com_distrator, data=bd)
summary(mod_deixou_a_via_com_distrator2)

#nao significativo

```
#### deixou_a_via_sem_distrator 
```{r}
mod_deixou_a_via_sem_distrator1 <-lm(tr_media_com_distrator ~ deixou_a_via_sem_distrator, data=bd)
summary(mod_deixou_a_via_sem_distrator1)

mod_deixou_via_a_sem_distrator2 <-lm(tr_media_sem_distrator ~ deixou_a_via_sem_distrator, data=bd)
summary(mod_deixou_via_a_sem_distrator2)

#nao significativo

```
#### velocidade_com_distrator
```{r}

mod_velocidade_com_distrator1 <-lm(tr_media_com_distrator ~ velocidade_com_distrator, data=bd)
summary(mod_velocidade_com_distrator1)

mod_velocidade_com_distrator2 <-lm(tr_media_sem_distrator ~ velocidade_com_distrator, data=bd)
summary(mod_velocidade_com_distrator2)

#significativo

```
#### velocidade_sem_distrator
```{r}

mod_velocidade_sem_distrator1 <-lm(tr_media_com_distrator ~ velocidade_sem_distrator, data=bd)
summary(mod_velocidade_sem_distrator1)

mod_velocidade_sem_distrator2 <-lm(tr_media_sem_distrator ~ velocidade_sem_distrator, data=bd)
summary(mod_velocidade_sem_distrator2)

#significativo

```


#### "velocidade_processamento_tempo"
```{r}
vel_proc_ctempo<-lm(bd$tr_media_com_distrator ~ bd$velocidade_processamento_tempo, data=bd)
vel_proc_stempo<-lm(bd$tr_media_sem_distrator ~ bd$velocidade_processamento_tempo, data=bd)
summary(vel_proc_ctempo)
summary(vel_proc_stempo)
#significante
```

#### "atencao_controlada_tempo"
```{r}
at_ctrl_ctempo<-lm(bd$tr_media_com_distrator~bd$atencao_controlada_tempo)
summary(at_ctrl_ctempo)
at_ctrl_stempo<-lm(bd$tr_media_sem_distrator~bd$atencao_controlada_tempo)
summary(at_ctrl_stempo)
#significante
```

#### "atencao_executiva_tempo"
```{r}
at_exe_ctempo<-lm(bd$tr_media_com_distrator~bd$atencao_executiva_tempo)
summary(at_exe_ctempo)
at_exe_stempo<-lm(bd$tr_media_sem_distrator~bd$atencao_executiva_tempo)
summary(at_exe_stempo)
#significante
```

#### atencao_automatica_erros_total
```{r}
at_auto_cerro<-lm(bd$tr_media_com_distrator~bd$atencao_automatica_erros_total)
summary(at_auto_cerro)
at_auto_serro<-lm(bd$tr_media_sem_distrator~bd$atencao_automatica_erros_total)
summary(at_auto_serro)
#n signif
```

#### velocidade_processamento_erros_total
```{r}
vel_proc_cerro<-lm(bd$tr_media_com_distrator~bd$velocidade_processamento_erros_total)
summary(vel_proc_cerro)
vel_proc_serro<-lm(bd$tr_media_sem_distrator~bd$velocidade_processamento_erros_total)
summary(vel_proc_serro)
#n signif
```
#### atencao_controlada_erros_total
```{r}
at_ctrl_cerro<-lm(bd$tr_media_com_distrator~bd$atencao_controlada_erros_total)
summary(at_ctrl_cerro)
at_ctrl_serro<-lm(bd$tr_media_sem_distrator~bd$atencao_controlada_erros_total)
summary(at_ctrl_serro)
#n signif
```

#### atencao_executiva_erros_total
```{r}
at_exe_cerro<-lm(bd$tr_media_com_distrator~bd$atencao_executiva_erros_total)
summary(at_exe_cerro)
at_exe_serro<-lm(bd$tr_media_sem_distrator~bd$atencao_executiva_erros_total)
summary(at_exe_serro)
#nao signif
```

#### inibição_total
```{r}
ini_c<-lm(bd$tr_media_com_distrator~bd$inibição_total)
summary(ini_c)
ini_s<-lm(bd$tr_media_sem_distrator~bd$inibição_total)
summary(ini_s)
#significante
```
#### flexibilidade_tempo
```{r}
flex_c<-lm(bd$tr_media_com_distrator~bd$flexibilidade_tempo)
# summary(flex_c)
flex_s<-lm(bd$tr_media_sem_distrator~bd$flexibilidade_tempo)
# summary(flex_s)
#significante
anova(flex_c)
```

#### trail_a_erros
```{r}
mod_trail_a_erros1 <-lm(tr_media_com_distrator ~ trail_a_erros, data=bd)
summary(mod_trail_a_erros1)

mod_trail_a_erros2 <-lm(tr_media_sem_distrator ~ trail_a_erros, data=bd)
summary(mod_trail_a_erros2)
#nao significante
```

#### Anova
```{r}
flex_c<-lm(bd$tr_media_com_distrator~bd$flexibilidade_tempo)
flex_s<-lm(bd$tr_media_sem_distrator~bd$flexibilidade_tempo)

anova(lm(bd$tr_media_com_distrator ~ bd$flexibilidade_tempo + bd$grupo),flex_c)
anova(lm(bd$tr_media_sem_distrator ~ bd$flexibilidade_tempo + bd$grupo),flex_s)
```


```{r}
mod_1 <- lm(bd$tr_media_com_distrator ~ bd$"inibição_total" + bd$grupo)
anova(mod_1,ini_c)
mod_1 <- lm(bd$tr_media_sem_distrator ~ bd$"inibição_total" + bd$grupo)
anova(mod_1,ini_s)

```

```{r}
mod_1 <- lm(bd$tr_media_com_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo)
mod_2 <- lm(bd$tr_media_com_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+ bd$grupo)
anova(mod_2,mod_1)
mod_1 <- lm(bd$tr_media_sem_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo)
mod_2 <- lm(bd$tr_media_sem_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+ bd$grupo)
anova(mod_2,mod_1)

```

```{r}
mod_1 <- lm(bd$tr_media_com_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+bd$velocidade_processamento_tempo)
mod_2 <- lm(bd$tr_media_com_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+ bd$velocidade_processamento_tempo + bd$grupo)
anova(mod_2,mod_1)

mod_1 <- lm(bd$tr_media_sem_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+bd$velocidade_processamento_tempo)
mod_2 <- lm(bd$tr_media_sem_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+ bd$velocidade_processamento_tempo + bd$grupo)
anova(mod_2,mod_1)
```

```{r}
mod_1 <- lm(bd$tr_media_com_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+bd$velocidade_processamento_tempo + bd$atencao_executiva_tempo)
mod_2 <- lm(bd$tr_media_com_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+ bd$velocidade_processamento_tempo + bd$atencao_executiva_tempo + bd$grupo)
anova(mod_2,mod_1)

mod_1 <- lm(bd$tr_media_sem_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+bd$velocidade_processamento_tempo + bd$atencao_executiva_tempo)
mod_2 <- lm(bd$tr_media_sem_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+ bd$velocidade_processamento_tempo + bd$atencao_executiva_tempo + bd$grupo)
anova(mod_2,mod_1)
```



```{r}
mod_1 <- lm(bd$tr_media_com_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+bd$velocidade_processamento_tempo + bd$atencao_executiva_tempo + bd$trail_b_tempo)
mod_2 <- lm(bd$tr_media_com_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+ bd$velocidade_processamento_tempo + bd$atencao_executiva_tempo+ bd$trail_b_tempo + bd$grupo)
anova(mod_2,mod_1)
mod_1 <- lm(bd$tr_media_sem_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+bd$velocidade_processamento_tempo + bd$atencao_executiva_tempo + bd$trail_b_tempo)
mod_2 <- lm(bd$tr_media_sem_distrator ~ bd$"inibição_total" + bd$flexibilidade_tempo+ bd$velocidade_processamento_tempo + bd$atencao_executiva_tempo+ bd$trail_b_tempo + bd$grupo)
anova(mod_2,mod_1)

```


```{r}
library(leaps)
```


```{r}
variaveis_sem<-c('tr_media_sem_distrator', 'escolaridade'
                 ,'locais', 
                 'tug_simples_segundo', 'tug_dupla_tarefa_segundos', 'n_palavras_em_pe', 'trail_a_tempo', 'trail_b_tempo', 'frey_copia_tempo', 
                'velocidade_sem_distrator', 'velocidade_processamento_tempo', 'inibição_total', 'flexibilidade_tempo' 
                 )
```

```{r}
## TESTE DE MODELO:  sem DISTRATOR
# stepwise forward regression
mod_sem <- regsubsets(tr_media_sem_distrator~., bd[, variaveis_sem], nvmax=length(variaveis_sem),
 force.in=c('trail_b_tempo', 'frey_copia_tempo', 'velocidade_processamento_tempo', 'inibição_total', 'flexibilidade_tempo' ), intercept=TRUE,
 method="forward")

# summary(mod_sem)
resultado = summary(mod_sem)

(num_coef <- which.min(resultado$bic) )# numero de coeficientes escolhidos
(fw_coef <- coef(mod_sem, num_coef))
```


```{r}
fit_all_sum = resultado

par(mfrow = c(2, 2))
plot(fit_all_sum$rss, xlab = "Number of Variables", ylab = "RSS", type = "b")

plot(fit_all_sum$adjr2, xlab = "Number of Variables", ylab = "Adjusted RSq", type = "b")
best_adj_r2 = which.max(fit_all_sum$adjr2)
points(best_adj_r2, fit_all_sum$adjr2[best_adj_r2],
       col = "red",cex = 2, pch = 20)

plot(fit_all_sum$cp, xlab = "Number of Variables", ylab = "Cp", type = 'b')
best_cp = which.min(fit_all_sum$cp)
points(best_cp, fit_all_sum$cp[best_cp], 
       col = "red", cex = 2, pch = 20)

plot(fit_all_sum$bic, xlab = "Number of Variables", ylab = "BIC", type = 'b')
best_bic = which.min(fit_all_sum$bic)
points(best_bic, fit_all_sum$bic[best_bic], 
       col = "red", cex = 2, pch = 20)
```

```{r}
mod_1 <- lm(bd$tr_media_sem_distrator~bd$trail_b_tempo+bd$frey_copia_tempo+bd$velocidade_processamento_tempo+bd$inibição_total+bd$flexibilidade_tempo+bd$escolaridade+bd$velocidade_sem_distrator, data = bd)

mod_2 <- lm(bd$tr_media_sem_distrator~bd$trail_b_tempo+bd$frey_copia_tempo+bd$velocidade_processamento_tempo+bd$inibição_total+bd$flexibilidade_tempo+bd$escolaridade+bd$velocidade_sem_distrator+bd$grupo, data = bd)

anova(mod_2,mod_1)
```

### Boostrap
```{r}
set.seed(112358)
n <-length(bd$tr_media_com_distrator)  #número de observações na amostra
B <- 1000 #número de amostras de bootstrap 
variable <-1:length(bd$tr_media_com_distrator)

amostra_bootstrap <- matrix(sample(variable, size=n*B, replace=TRUE), nrow=n, ncol = B)
dim(amostra_bootstrap)

amostra_bootstrap<-as.data.frame(amostra_bootstrap)
#View(amostra_bootstrap)

valores_p <-c()
```

```{r}
for (i in 1:1000){
  #com grupo
  mod1<-lm(tr_media_com_distrator~., bd[amostra_bootstrap[, i], c('tr_media_com_distrator', 'trail_b_tempo', 'frey_copia_tempo', 'velocidade_processamento_tempo', 'inibição_total', 'flexibilidade_tempo','grupo') ])
  
  #sem grupo:
    mod2<-lm(tr_media_com_distrator~., bd[amostra_bootstrap[, i], c('tr_media_com_distrator', 'trail_b_tempo', 'frey_copia_tempo', 'velocidade_processamento_tempo', 'inibição_total', 'flexibilidade_tempo') ])
    
    teste<-anova(mod1, mod2)
  valores_p<-c(valores_p, teste$`Pr(>F)`[2])
}
```


```{r}
####quantidade de valores_p menores que 0.05
length(valores_p[valores_p<0.05])

####quantidade de valores_p menores que 0.1
length(valores_p[valores_p<0.1])
```