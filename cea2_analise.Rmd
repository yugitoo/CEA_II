---
title: "CEA 2"
author:
- "Hei Yin Kwok"
- "Karine Tavares Cruz"
- "Yugo Oyama"
date: "2/9/2021"
output: pdf_document
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Bibliotecas
```{r}
library(readxl)
library(robustbase)
library(RColorBrewer) #baixar paleta de cores

```


## Leitura dos dados
```{r}
bd <- read_excel("Dados.xlsx", sheet = "dados")
bd$grupo <- factor(bd$grupo)
head(bd)
```

## Funções
```{r}
##  Plota boxplot e densidade
plota_boxplot = function(col_box){

  par(mfrow=c(2,3)) # organiza a disposicao dos graficos
  for (i in col_box) {
    j <- eval(parse(text = paste0("bd$",i))) # coluna i
    adjbox(split(j,bd$grupo), col=cores, main = paste0(i," por grupo"))
    adjbox(j, col=cores, main = paste0(i," geral"))
    plot(density(na.omit(j)), main = paste0(i," geral"))
  }
}


## Plota dispersões
plota_disp = function(col_disp, col_resp){

  par(mfrow=c(2,2)) # organiza a disposicao dos graficos
  for (i in col_disp) {
    j <- eval(parse(text = paste0("bd$",i))) # coluna i
    for (k in col_resp) {
      l <- eval(parse(text = paste0("bd$",k)))
      plot(j,l,pch = 16,  main = paste0(i," por ", k), col=bd$grupo)  
  }
}
}
```


## Analise descritiva

Parametros uteis
```{r}
cores <- brewer.pal(3, "Set2")
col_names <- names(bd)

```


### Boxplots e Densidades
```{r}
col_box <- c("idade","n_doencas_associadas","escolaridade","ave_meses") # colunas que serao feitos boxplots

plota_boxplot(col_box)

```

## Dispersao
```{r}
col_disp <-  c("idade","n_doencas_associadas","escolaridade","ave_meses") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_desvio_padrao_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)
```
###  TEMPO DE REAÇÃO, VELOCIDADE E ERROS
####  COM DISTRATOR

```{r}
### Boxplots e Densidades
col_box <- c("tr_media_com_distrator", "velocidade_com_distrator ") # colunas que serao feitos boxplots

plota_boxplot(col_box)
```


```{r}
# Vezes que deixou a via com distrator
deixou_via_com = table(bd$grupo, bd$deixou_via_com_distrator)
deixou_via_com  # quantas pessoas cometeram x erros

aggregate(bd$deixou_via_com_distrator, by=list(Category=bd$grupo), FUN=sum) # quantos erros aconteceram
```


```{r}
# Vezes que perdeu a placa com distrator
perdeu_placa_com = table(bd$grupo, bd$perdeu_placa_com_distrator)
perdeu_placa_com # quantas pessoas cometeram x erros

aggregate(bd$perdeu_placa_com_distrator, by=list(Category=bd$grupo), FUN=sum) # quantos erros aconteceram
```

####  SEM DISTRATOR
```{r}
####  SEM DISTRATOR   ########################################

### Boxplots e Densidades
col_box <- c("tr_media_sem_distrator", "velocidade_sem_distrator ") # colunas que serao feitos boxplots

par(mfrow=c(2,3)) # organiza a disposicao dos graficos

plota_boxplot(col_box)

# Vezes que deixou a via
deixou_via_sem = table(bd$grupo, bd$deixou_a_via_sem_distrator)
deixou_via_sem
aggregate(bd$deixou_a_via_sem_distrator, by=list(Category=bd$grupo), FUN=sum)

# Vezes que perdeu a placa
perdeu_placa_sem = table(bd$grupo, bd$perdeu_placa_sem_distrator)
perdeu_placa_sem 
aggregate(bd$perdeu_placa_sem_distrator, by=list(Category=bd$grupo), FUN=sum)

```

###   HÁBITOS DE DIREÇÃO

#### HORAS DE DIREÇÃO
```{r}

col_box <- c("dirigia_horas_antes", "dirige_horas_atual") # colunas que serao feitos boxplots

plota_boxplot(col_box)
```


```{r}
## Dispersao
col_disp <-  c("dirigia_horas_antes", "dirige_horas_atual") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_desvio_padrao_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)
```

#### DIAS DE DIREÇÃO
```{r}

dias_antes = table(bd$grupo, bd$dirigia_dias_antes)
dias_antes

dias_atual = table(bd$grupo, bd$dirige_dias_atual)
dias_atual

```


#### SITUAÇÕES DE DIREÇÃO
```{r}

chuva = table(bd$grupo, bd$chuva)
chuva

noite = table(bd$grupo, bd$noite)
noite

congestionamento = table(bd$grupo, bd$congestionamento)
congestionamento


rush = table(bd$grupo, bd$rush)
rush

locais = table(bd$grupo, bd$locais)
locais
```

### ACUIDADE VISUAL
```{r}
## Dispersao
col_disp <-  c("acuidade_visual_d", "acuidade_visual_e") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)

#dispersao
col_resp <- c("velocidade_com_distrator ","velocidade_com_distrator ") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)

###################################
#perdas de placa distrator

acui_com_d = table(bd$acuidade_visual_d, bd$perdeu_placa_com_distrator)
acui_com_d

acui_sem_d = table(bd$acuidade_visual_d, bd$perdeu_placa_sem_distrator)
acui_sem_d

acui_com_e = table(bd$acuidade_visual_e, bd$perdeu_placa_com_distrator)
acui_com_e

acui_sem_e = table(bd$acuidade_visual_e, bd$perdeu_placa_sem_distrator)
acui_sem_e

#deixar via

via_com_d = table(bd$acuidade_visual_d, bd$perdeu_placa_com_distrator)
via_com_d
via_sem_d = table(bd$acuidade_visual_d, bd$perdeu_placa_sem_distrator)
via_sem_d


via_com_e = table(bd$acuidade_visual_e, bd$perdeu_placa_com_distrator)
via_com_e
via_sem_e = table(bd$acuidade_visual_e, bd$perdeu_placa_sem_distrator)
via_sem_e

```


### ESTEREOPSIA

```{r}
estereopsia = table(bd$grupo, bd$estereopsia)
estereopsia

adjbox(split(bd$"tr_media_com_distrator",bd$estereopsia), col=cores)
adjbox(split(bd$"tr_media_sem_distrator",bd$estereopsia), col=cores)
adjbox(split(bd$"velocidade_com_distrator",bd$estereopsia), col=cores)
adjbox(split(bd$"velocidade_sem_distrator",bd$estereopsia), col=cores)


```


### VISÃO CROMÁTICA

```{r}
v_c = table(bd$grupo, bd$visao_cromatica)
v_c

adjbox(split(bd$"tr_media_com_distrator",bd$visao_cromatica), col=cores)
adjbox(split(bd$"tr_media_sem_distrator", bd$visao_cromatica), col=cores)
adjbox(split(bd$"velocidade_com_distrator", bd$visao_cromatica), col=cores)
adjbox(split(bd$"velocidade_sem_distrator", bd$visao_cromatica), col=cores)


```

### ADAPTOMETRIA
```{r}
adap = table(bd$grupo, bd$adaptometria)
adap

adjbox(split(bd$"tr_media_com_distrator", bd$adaptometria), col=cores)
adjbox(split(bd$"tr_media_sem_distrator", bd$adaptometria), col=cores)
adjbox(split(bd$"velocidade_com_distrator", bd$adaptometria), col=cores)
adjbox(split(bd$"velocidade_sem_distrator", bd$adaptometria), col=cores)


```

### CAMPIMETRIA PERIFERICA
```{r}
cp = table(bd$grupo, bd$campimetria_periferica)
cp

adjbox(split(bd$"tr_media_com_distrator", bd$campimetria_periferica), col=cores)
adjbox(split(bd$"tr_media_sem_distrator", bd$campimetria_periferica), col=cores)
adjbox(split(bd$"velocidade_com_distrator", bd$campimetria_periferica), col=cores)
adjbox(split(bd$"velocidade_sem_distrator", bd$campimetria_periferica), col=cores)

```

### TUG
```{r}

col_box <- c("tug_simples_segundo", "tug_dupla_tarefa_segundos", "n_palavras_sentado", "n_palavras_em_pe") # colunas que serao feitos boxplots

plota_boxplot(col_box)

## Dispersao
col_disp <-  c("tug_simples_segundo", "tug_dupla_tarefa_segundos", "n_palavras_sentado", "n_palavras_em_pe") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)

## Dispersao
col_disp <-  c("tug_simples_segundo", "tug_dupla_tarefa_segundos", "n_palavras_sentado", "n_palavras_em_pe") # colunas que serao feitas grafico de dispersao
col_resp <- c("velocidade_com_distrator","velocidade_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)

```

### ADM TORNOZELO DIREITO

```{r}

col_box <- c("adm_tornozelo_d") # colunas que serao feitos boxplots

plota_boxplot(col_box)

## Dispersao
col_disp <-  c("adm_tornozelo_d") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator", "velocidade_com_distrator","velocidade_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)



```

### MEEM

``` {r}

col_box <- c("meem") # colunas que serao feitos boxplots

plota_boxplot(col_box)

## Dispersao
col_disp <-  c("meem") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator", "velocidade_com_distrator","velocidade_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)



```

### ATENÇÃO AUTOMÁTICA, VELOCIDADE DE PROCESSAMENTO, ATENÇÃO CONTROLADA, ATENÇÃO EXECUTIVA

```{r}

## Tempos

col_box <- c("fdt_atencao_automatica_tempo", "velocidade_processamento_tempo", "atencao_controlada_tempo", "atencao_executiva_tempo") # colunas que serao feitos boxplots

plota_boxplot(col_box)

## Dispersao
col_disp <-  c("fdt_atencao_automatica_tempo", "velocidade_processamento_tempo", "atencao_controlada_tempo", "atencao_executiva_tempo") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)

## Dispersao
col_disp <-  c("fdt_atencao_automatica_tempo", "velocidade_processamento_tempo", "atencao_controlada_tempo", "atencao_executiva_tempo") # colunas que serao feitas grafico de dispersao
col_resp <- c("velocidade_com_distrator","velocidade_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)

## ERROS:

atencao_automatica = table(bd$grupo, bd$atencao_automatica_erros_total)
atencao_automatica
aggregate(bd$atencao_automatica_erros_total, by=list(Category=bd$grupo), FUN=sum)

velocidade_processamento = table(bd$grupo, bd$velocidade_processamento_erros_total)
velocidade_processamento
aggregate(bd$velocidade_processamento_erros_total, by=list(Category=bd$grupo), FUN=sum)


atencao_controlada = table(bd$grupo, bd$atencao_controlada_erros_total)
atencao_controlada
aggregate(bd$atencao_controlada_erros_total, by=list(Category=bd$grupo), FUN=sum)


atencao_executiva = table(bd$grupo, bd$atencao_executiva_erros_total)
atencao_executiva
aggregate(bd$atencao_executiva_erros_total, by=list(Category=bd$grupo), FUN=sum)



```

### INIBIÇÃO TOTAL
``` {r}

col_box <- c("inibição_total") # colunas que serao feitos boxplots

plota_boxplot(col_box)

## Dispersao
col_disp <-  c("inibição_total") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator", "velocidade_com_distrator","velocidade_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)


```

### FLEXIBILIDADE
``` {r}

col_box <- c("flexibilidade_tempo") # colunas que serao feitos boxplots

plota_boxplot(col_box)

## Dispersao
col_disp <-  c("flexibilidade_tempo") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator", "velocidade_com_distrator","velocidade_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)


```

### TRAIL

``` {r}
## TEMPO
col_box <- c("trail_a_tempo", "trail_b_tempo") # colunas que serao feitos boxplots

plota_boxplot(col_box)

## Dispersao
col_disp <-  c("trail_a_tempo", "trail_b_tempo") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator", "velocidade_com_distrator","velocidade_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)

#ERROS

trail_a_erros = table(bd$grupo, bd$trail_a_erros)
trail_a_erros
aggregate(bd$trail_a_erros, by=list(Category=bd$grupo), FUN=sum)


trail_b_erros = table(bd$grupo, bd$trail_b_erros)
trail_b_erros
aggregate(bd$trail_b_erros, by=list(Category=bd$grupo), FUN=sum)

## Dispersao
col_disp <-  c("trail_a_erros", "trail_b_erros") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator", "velocidade_com_distrator","velocidade_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)
```

### FREY
``` {r}

col_box <- c("frey_copia_tempo", "frey_evocacao3_tempo", "frey_evocacao30_tempo") # colunas que serao feitos boxplots

plota_boxplot(col_box)

## Dispersao
col_disp <-  c("frey_copia_tempo", "frey_evocacao3_tempo", "frey_evocacao30_tempo") # colunas que serao feitas grafico de dispersao
col_resp <- c("tr_media_com_distrator","tr_media_sem_distrator", "velocidade_com_distrator","velocidade_sem_distrator") # colunas com variaveis resposta

plota_disp(col_disp, col_resp)

```
